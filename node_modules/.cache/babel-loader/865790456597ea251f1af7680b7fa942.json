{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, GoogleAuthProvider, FacebookAuthProvider, signInWithPopup, updateProfile, getIdToken, signOut } from \"firebase/auth\";\nimport initializeAuthentication from \"../Firebase/firebase.init\"; // initialize firebase app\n\ninitializeAuthentication();\n\nconst useFirebase = () => {\n  _s();\n\n  const [user, setUser] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [authError, setAuthError] = useState(\"\");\n  const [admin, setAdmin] = useState(false);\n  const [scholar, setScholar] = useState(false);\n  const [token, setToken] = useState(\"\");\n  const [userInfo, setUserInfo] = useState(\"\");\n  const [scholars, setScholars] = useState();\n  const auth = getAuth();\n  const googleProvider = new GoogleAuthProvider();\n\n  const registerUser = (email, password, name, history) => {\n    createUserWithEmailAndPassword(auth, email, password).then(userCredential => {\n      setAuthError(\"\");\n      const newUser = {\n        email,\n        displayName: name\n      };\n      setUser(newUser);\n      setLoading(false); // save user to the database\n\n      saveUser(email, name, \"POST\"); // send name to firebase after creation\n\n      updateProfile(auth.currentUser, {\n        displayName: name\n      }).then(() => {}).catch(error => {});\n      history.replace(\"/\");\n    }).catch(error => {\n      setAuthError(error.message);\n      console.log(error);\n    });\n  };\n\n  const loginUser = (email, password, location, history) => {\n    signInWithEmailAndPassword(auth, email, password).then(userCredential => {\n      var _location$state;\n\n      const destination = (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.from) || \"/\";\n      history.replace(destination);\n      setAuthError(\"\");\n    }).catch(error => {\n      setAuthError(error.message);\n    }).finally(() => setLoading(false));\n  };\n\n  const signInWithGoogle = (location, history) => {\n    signInWithPopup(auth, googleProvider).then(result => {\n      var _location$state2;\n\n      const user = result.user;\n      saveUser(user.email, user.displayName, \"PUT\"); // saveUser(user.email, user.displayName, \"PUT\");\n\n      setAuthError(\"\");\n      const destination = (location === null || location === void 0 ? void 0 : (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.from) || \"/\";\n      history.replace(destination);\n    }).catch(error => {\n      setAuthError(error.message);\n    });\n  }; // observer user state\n\n\n  useEffect(() => {\n    const unsubscribed = onAuthStateChanged(auth, user => {\n      if (user) {\n        setUser(user);\n        setLoading(false);\n        getIdToken(user).then(idToken => {\n          setToken(idToken);\n        });\n      } else {\n        setUser({});\n        setLoading(false);\n      }\n    });\n    return () => unsubscribed;\n  }, [auth]);\n  useEffect(() => {\n    fetch(`https://darulmuttaquine-server.vercel.app/users/${user === null || user === void 0 ? void 0 : user.email}`).then(res => res.json()).then(data => setAdmin(data === null || data === void 0 ? void 0 : data.admin));\n  }, [user === null || user === void 0 ? void 0 : user.email]);\n  useEffect(() => {\n    fetch(`https://darulmuttaquine-server.vercel.app/users/${user === null || user === void 0 ? void 0 : user.email}`).then(res => res.json()).then(data => setScholar(data === null || data === void 0 ? void 0 : data.scholar));\n  }, [user === null || user === void 0 ? void 0 : user.email]);\n  useEffect(() => {\n    fetch(`https://darulmuttaquine-server.vercel.app/users/profile/${user === null || user === void 0 ? void 0 : user.email}`).then(res => res.json()).then(data => setUserInfo(data));\n  }, [user === null || user === void 0 ? void 0 : user.email]);\n\n  const logOut = () => {\n    signOut(auth).then(() => {\n      setUser({});\n      setLoading(false); // Sign-out successful.\n    }).catch(error => {// An error happened.\n    });\n  };\n\n  const saveUser = (email, displayName, method) => {\n    console.log(displayName);\n    const user = {\n      email,\n      displayName\n    };\n    fetch(\"https://darulmuttaquine-server.vercel.app/users\", {\n      method: method,\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify(user)\n    }).then();\n  }; // scholar finding\n\n\n  useEffect(() => {\n    fetch(\"https://darulmuttaquine-server.vercel.app/users\").then(res => res.json()).then(data => {\n      const collectedScholar = data.filter(data => data.role === \"scholar\");\n      setScholars(collectedScholar);\n    });\n  }, []);\n  return {\n    user,\n    userInfo,\n    admin,\n    scholar,\n    scholars,\n    token,\n    loading,\n    authError,\n    registerUser,\n    loginUser,\n    signInWithGoogle,\n    logOut\n  };\n};\n\n_s(useFirebase, \"CjQtM1MQk8UNTBFqEc8Mg6yJCoY=\");\n\nexport default useFirebase;","map":{"version":3,"sources":["/Users/macbookair/Desktop/DMF_SITE/light-of-islam-client/src/hooks/useFirebase.js"],"names":["useState","useEffect","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","onAuthStateChanged","GoogleAuthProvider","FacebookAuthProvider","signInWithPopup","updateProfile","getIdToken","signOut","initializeAuthentication","useFirebase","user","setUser","loading","setLoading","authError","setAuthError","admin","setAdmin","scholar","setScholar","token","setToken","userInfo","setUserInfo","scholars","setScholars","auth","googleProvider","registerUser","email","password","name","history","then","userCredential","newUser","displayName","saveUser","currentUser","catch","error","replace","message","console","log","loginUser","location","destination","state","from","finally","signInWithGoogle","result","unsubscribed","idToken","fetch","res","json","data","logOut","method","headers","body","JSON","stringify","collectedScholar","filter","role"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  onAuthStateChanged,\n  GoogleAuthProvider,\n  FacebookAuthProvider,\n  signInWithPopup,\n  updateProfile,\n  getIdToken,\n  signOut,\n} from \"firebase/auth\";\nimport initializeAuthentication from \"../Firebase/firebase.init\";\n\n// initialize firebase app\ninitializeAuthentication();\n\nconst useFirebase = () => {\n  const [user, setUser] = useState({});\n  const [loading, setLoading] = useState(true);\n\n  const [authError, setAuthError] = useState(\"\");\n  const [admin, setAdmin] = useState(false);\n  const [scholar, setScholar] = useState(false);\n  const [token, setToken] = useState(\"\");\n  const [userInfo, setUserInfo] = useState(\"\");\n\n  const [scholars, setScholars] = useState();\n\n  const auth = getAuth();\n  const googleProvider = new GoogleAuthProvider();\n\n  const registerUser = (email, password, name, history) => {\n    createUserWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        setAuthError(\"\");\n        const newUser = { email, displayName: name };\n        setUser(newUser);\n        setLoading(false);\n        // save user to the database\n        saveUser(email, name, \"POST\");\n        // send name to firebase after creation\n        updateProfile(auth.currentUser, {\n          displayName: name,\n        })\n          .then(() => {})\n          .catch((error) => {});\n        history.replace(\"/\");\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n        console.log(error);\n      });\n  };\n\n  const loginUser = (email, password, location, history) => {\n    signInWithEmailAndPassword(auth, email, password)\n      .then((userCredential) => {\n        const destination = location?.state?.from || \"/\";\n        history.replace(destination);\n        setAuthError(\"\");\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n      })\n      .finally(() => setLoading(false));\n  };\n\n  const signInWithGoogle = (location, history) => {\n    signInWithPopup(auth, googleProvider)\n      .then((result) => {\n        const user = result.user;\n        saveUser(user.email, user.displayName, \"PUT\");\n        // saveUser(user.email, user.displayName, \"PUT\");\n        setAuthError(\"\");\n        const destination = location?.state?.from || \"/\";\n        history.replace(destination);\n      })\n      .catch((error) => {\n        setAuthError(error.message);\n      });\n  };\n\n  // observer user state\n  useEffect(() => {\n    const unsubscribed = onAuthStateChanged(auth, (user) => {\n      if (user) {\n        setUser(user);\n        setLoading(false);\n        getIdToken(user).then((idToken) => {\n          setToken(idToken);\n        });\n      } else {\n        setUser({});\n        setLoading(false);\n      }\n    });\n    return () => unsubscribed;\n  }, [auth]);\n\n  useEffect(() => {\n    fetch(`https://darulmuttaquine-server.vercel.app/users/${user?.email}`)\n      .then((res) => res.json())\n      .then((data) => setAdmin(data?.admin));\n  }, [user?.email]);\n\n  useEffect(() => {\n    fetch(`https://darulmuttaquine-server.vercel.app/users/${user?.email}`)\n      .then((res) => res.json())\n      .then((data) => setScholar(data?.scholar));\n  }, [user?.email]);\n\n  useEffect(() => {\n    fetch(\n      `https://darulmuttaquine-server.vercel.app/users/profile/${user?.email}`\n    )\n      .then((res) => res.json())\n      .then((data) => setUserInfo(data));\n  }, [user?.email]);\n\n  const logOut = () => {\n    signOut(auth)\n      .then(() => {\n        setUser({});\n        setLoading(false);\n        // Sign-out successful.\n      })\n      .catch((error) => {\n        // An error happened.\n      });\n  };\n\n  const saveUser = (email, displayName, method) => {\n    console.log(displayName);\n    const user = { email, displayName };\n    fetch(\"https://darulmuttaquine-server.vercel.app/users\", {\n      method: method,\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n      body: JSON.stringify(user),\n    }).then();\n  };\n\n  // scholar finding\n  useEffect(() => {\n    fetch(\"https://darulmuttaquine-server.vercel.app/users\")\n      .then((res) => res.json())\n      .then((data) => {\n        const collectedScholar = data.filter((data) => data.role === \"scholar\");\n        setScholars(collectedScholar);\n      });\n  }, []);\n\n  return {\n    user,\n    userInfo,\n    admin,\n    scholar,\n    scholars,\n    token,\n    loading,\n    authError,\n    registerUser,\n    loginUser,\n    signInWithGoogle,\n    logOut,\n  };\n};\n\nexport default useFirebase;\n"]},"metadata":{},"sourceType":"module"}